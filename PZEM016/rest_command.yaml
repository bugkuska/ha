#Rest commamd    
rest_command:
  send_pzem016_raw_5m:
    url: "https://colton-rheoscopic-kamron.ngrok-free.dev/webhook/ha-pzem016-raw-5m"
    method: POST
    content_type: "application/json"
    
    payload: >-
      {
        "site": "MSUSmartFarm",
        "device": "PZEM016",
        "timestamp": "{{ now().isoformat() }}",
        "ts_5m": "{{ now().replace(second=0, microsecond=0).isoformat() }}",
        "row_key": "MSUSmartFarm_PZEM016_{{ now().replace(second=0, microsecond=0).isoformat() }}",

        "billing_period": "{{ states('sensor.pea_billing_period_th') }}",
        "kwh_cycle": {{ states('sensor.monthly_energy_pea_display') | float(0) }},

        "voltage_v": {{ states('sensor.esp32_pzem016_powermon_voltage') | float(0) }},
        "current_a": {{ states('sensor.esp32_pzem016_powermon_current') | float(0) }},
        "power_w": {{ states('sensor.esp32_pzem016_powermon_power') | float(0) }},
        "frequency_hz": {{ states('sensor.esp32_pzem016_powermon_frequency') | float(0) }},
        "power_factor": {{ states('sensor.esp32_pzem016_powermon_power_factor') | float(0) }},
        "kwh_today": {{ states('sensor.esp32_pzem016_powermon_total_daily_energy') | float(0) }},

        "base_cost": {{ states('sensor.base_cost') | float(0) }},
        "service_charge": {{ states('input_number.servicecharge') | float(0) }},
        "ft_rate": {{ states('input_number.ftcharge') | float(0) }},
        "ft_cost": {{ states('sensor.ft_cost') | float(0) }},
        "subtotal_before_vat": {{ states('sensor.sub_total_before_vat') | float(0) }},
        "vat_7_percent": {{ states('sensor.vat_7_percent') | float(0) }},
        "total_cost": {{ states('sensor.total_cost') | float(0) }}
      }
